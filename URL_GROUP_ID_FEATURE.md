# üîó –ü–æ–¥–¥–µ—Ä–∂–∫–∞ group_id –≤ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–¢–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–¥–∞—á—É `group_id` —á–µ—Ä–µ–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ –ø—Ä—è–º–æ–π —Å—Å—ã–ª–∫–µ —Å —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–º group_id.

## üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### URL —Å group_id:
```
http://localhost:3000?user_id=32618&group_id=53178&context=Bot_step&channel_type_id=1&sign=e56fdc0433fc23297c08efc13ed394b5
```

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
1. ‚úÖ group_id **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è** –∏–∑ URL
2. ‚úÖ –ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ **OAuth —Å—Ç—Ä–∞—Ç–µ–≥–∏—é** —á–µ—Ä–µ–∑ state –ø–∞—Ä–∞–º–µ—Ç—Ä  
3. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å **–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º** –Ω–∞–¥ –¥–∞–Ω–Ω—ã–º–∏ –æ—Ç Senler API
4. ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ **localStorage** –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### üîÑ –û–±—ã—á–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:
```
GET /?group_id=53178
  ‚Üì
GET /auth/senler?group_id=53178 (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
  ‚Üì
OAuth —Å state: {"groupId": "53178"}
  ‚Üì
Callback –∏—Å–ø–æ–ª—å–∑—É–µ—Ç group_id –∏–∑ state
```

### üñºÔ∏è Popup –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:
```
–ö–ª–∏–∫ "–í–æ–π—Ç–∏" –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å group_id=53178
  ‚Üì  
GET /auth/senler/popup?group_id=53178
  ‚Üì
OAuth —Å state: {"popup": true, "groupId": "53178"}
  ‚Üì
Callback –∏—Å–ø–æ–ª—å–∑—É–µ—Ç group_id –∏–∑ state
```

## üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### üîç –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ group_id:
```javascript
// –°–µ—Ä–≤–µ—Ä–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ (routes/index.ts)
const groupIdFromUrl = req.query.group_id as string;

// –ü–µ—Ä–µ–¥–∞—á–∞ –≤ HTML —á–µ—Ä–µ–∑ meta —Ç–µ–≥
<meta name="url-group-id" content="${groupIdFromUrl}">

// –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ (auth.js)
const urlGroupIdMeta = document.querySelector('meta[name="url-group-id"]');
const groupIdFromUrl = urlGroupIdMeta.getAttribute('content');
```

### üéØ –ü–µ—Ä–µ–¥–∞—á–∞ –≤ OAuth:
```javascript
// –û–±—ã—á–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
passport.authenticate('senler', {
  state: JSON.stringify({ groupId: groupIdFromUrl })
});

// Popup –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è  
passport.authenticate('senler', {
  state: JSON.stringify({ popup: true, groupId: groupIdFromUrl })
});
```

### üèÜ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤ callback:
```javascript
// –í callback –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ
const stateData = JSON.parse(req.query.state);
const groupIdFromState = stateData.groupId;

// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: URL > Senler API
if (groupIdFromState) {
  groupId = groupIdFromState; // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–∑ URL
} else {
  groupId = user?.groupId;     // –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç Senler
}
```

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### üéØ –¢–æ—á–Ω–æ—Å—Ç—å:
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π group_id
- –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö Senler API
- –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –µ—Å–ª–∏ Senler –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç group_id

### üîó –£–¥–æ–±—Å—Ç–≤–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
- –ü—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ —Å group_id —Ä–∞–±–æ—Ç–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å—Å—ã–ª–∫–∞–º–∏

### üñºÔ∏è Iframe –ø–æ–¥–¥–µ—Ä–∂–∫–∞:
- –†–∞–±–æ—Ç–∞–µ—Ç –≤ iframe —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≤ URL
- localStorage –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–∫–Ω–∞—Ö

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### üìù –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

**1. URL –±–µ–∑ group_id:**
```
http://localhost:3000
‚Üí –û–±—ã—á–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, group_id –æ—Ç Senler API
```

**2. URL —Å group_id:**
```
http://localhost:3000?group_id=53178
‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ—Ç group_id=53178 –∏–∑ URL
```

**3. Popup —Å group_id:**
```
–û—Ç–∫—Ä—ã—Ç—å http://localhost:3000?group_id=53178
–ù–∞–∂–∞—Ç—å "–í–æ–π—Ç–∏" ‚Üí popup –∏—Å–ø–æ–ª—å–∑—É–µ—Ç group_id=53178
```

**4. –°–º–µ–Ω–∞ group_id:**
```
localStorage: group_id=12345
URL: group_id=53178
‚Üí –û–±–Ω–æ–≤–ª—è–µ—Ç localStorage –¥–æ 53178
```

### üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ DevTools:

**Console –ª–æ–≥–∏:**
```javascript
üìå –ò—Å–ø–æ–ª—å–∑—É–µ–º group_id –∏–∑ URL: 53178
üìå –ü–µ—Ä–µ–¥–∞–µ–º group_id –≤ popup: 53178
üìå –û–±–Ω–æ–≤–ª—è–µ–º group_id –∏–∑ URL: 53178
```

**localStorage:**
```javascript
localStorage.getItem('senler_group_id') // '53178'
```

**Meta —Ç–µ–≥:**
```html
<meta name="url-group-id" content="53178">
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è:
- group_id –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –≤—ã–≤–æ–¥–µ –≤ HTML
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–µ –≤ API endpoints

### üõ°Ô∏è –ó–∞—â–∏—Ç–∞:
- –ù–µ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞)
- XSS –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

## üöÄ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Å—ã–ª–∫–∏ –±–µ–∑ group_id —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ
- Fallback –Ω–∞ –¥–∞–Ω–Ω—ã–µ –æ—Ç Senler API
- –ù–µ –ª–æ–º–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### üñºÔ∏è Iframe –ø–æ–¥–¥–µ—Ä–∂–∫–∞:
- –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ iframe —Å URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- localStorage —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Popup –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—á–∏—Ç—ã–≤–∞–µ—Ç group_id

## üìö –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### üîó –°–æ–∑–¥–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫:
```javascript
// JavaScript –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Å—ã–ª–æ–∫ —Å group_id
const groupId = '53178';
const integrationUrl = `https://your-domain.com?group_id=${groupId}`;

// HTML —Å—Å—ã–ª–∫–∞
<a href="https://your-domain.com?group_id=53178">
  –û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –¥–ª—è –≥—Ä—É–ø–ø—ã 53178
</a>
```

### üñºÔ∏è Iframe –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ:
```html
<!-- Iframe —Å group_id -->
<iframe 
  src="https://your-domain.com?group_id=53178" 
  width="800" 
  height="600">
</iframe>
```

### üì± API –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```javascript
// –ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å group_id –∏–∑ URL
fetch('/auth/subscribers', {
  method: 'POST',
  body: JSON.stringify({
    accessToken: 'token',
    groupId: '53178' // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ URL
  })
});
```

---

**üéØ –¢–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç group_id –∏–∑ URL, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Ç–æ—á–Ω—É—é –ø—Ä–∏–≤—è–∑–∫—É –∫ –Ω—É–∂–Ω–æ–π –≥—Ä—É–ø–ø–µ!** 